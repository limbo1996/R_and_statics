# R语言和统计学（1）





## 样本量和检验效能估计

检验效能分析可以在给定置信度的情况下，判断检验到给定效应值时所需的样本量。同样可以在给定置信度水平的情况下，计算在某样本量内能检测到给定效应值的概率。

基于样本数据
$$
(\bar{X_1} - \bar{X_2} ) / (\frac{S}{\sqrt{n}})
$$


$\bar{X_1}$和$\bar{X_2}$代表两个样本的均值，S是标准差，n为样本量

**参考`pwr`包**



## 定量资料的统计描述

### 统计描述基础

#### 集中趋势

数据的中心点在什么地方，数据集中分布趋势

#### 离散趋势

分散程度

#### 偏度

数据曲线的对称性

#### 峰度

数据曲线顶部的峰态特征

### 集中趋势

集中趋势用平均是、中位数、众数表示

### 离散趋势

#### 极差， 平均差， 方差和标准差

#### 变异系数

变异系数表示标准差相对于平均数的大小的相对量，即标准差相对于均值的百分比
$$
离散程度 = \frac{\sigma}{\mu} * 100%
$$

### R



`summary`函数返回最小值、最大值、四分位数、均值

```R
> a <- c(1:1000)
> summary(a)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    1.0   250.8   500.5   500.5   750.2  1000.0 
```



`describe`函数返回变量和观测的数量、缺失值和唯一的数目、平均值、分位数，5个最大值5个最小值

```R
> install.packages("Hmisc")
> library(Hmisc)
> a <- c(1:1000)
> describe(a)
a 
       n  missing distinct     Info     Mean      Gmd 
    1000        0     1000        1    500.5    333.7 
     .05      .10      .25      .50      .75      .90 
   50.95   100.90   250.75   500.50   750.25   900.10 
     .95 
  950.05 

lowest :    1    2    3    4    5, highest:  996  997  998  999 1000
```

## t检验

### 单样本t检验

推断样本与总体均值有无差异
$$
t = \frac{\bar{X} - \mu}{S / \sqrt{n}}
$$

#### R语言t检验

`t.test()`

#### 无原始数据的t检验

如果没有原始数据，需要根据t检验的共识和概率函数`pt()`来获得t检验的结果

就是没有具体数据只有统计量的情况下用`pt()`来计算t检验的p值

```R
> u0 <- 72
> u1 <- 74.2
> s <- 6.5
> n <- 25
> t <- (u0 - u1) / (s / sqrt(n))
> v <- n - 1
> a <- pt(-abs(t), v)
> a
[1] 0.05176593
```



### 配对t检验

即成对资料，比如减肥前后体重，用药前后测定数据，n例即n对数据
$$
t = \frac{\bar{d}}{S_d / \sqrt{n}}, v = n - 1
$$
$\bar{d}$为配对数据的差的均值， $S_d$为差值的标准差

#### R语言配对t检验

`t.test(paired = T)`

### 独立样本t检验

比较两组均值有无显著差异

#### 两独立样本t检验

当两样本含量较小，且均来自正态总体，根据两总体方差是否相等采用不同的检验方法

1. 总体方差相等
1. 总体方差不相等



##### 首先检验方差齐性

`var.test`

之后根据方差齐性选择使用哪种检验方法

`t.test(var.equal = T/F)`

